/**
 * @license
 * pixi.js - v2.2.7
 * Copyright (c) 2012-2014, Mat Groves
 * http://goodboydigital.com/
 *
 * Compiled: 2020-07-02
 *
 * pixi.js is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license.php
 */

 (function(){var E=E||{};E.WEBGL_RENDERER=0,E.CANVAS_RENDERER=1,E.VERSION="v2.2.7",E.blendModes={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},E.scaleModes={DEFAULT:0,LINEAR:0,NEAREST:1},E._UID=0,"undefined"!=typeof Float32Array?(E.Float32Array=Float32Array,E.Uint16Array=Uint16Array,E.Uint32Array=Uint32Array,E.ArrayBuffer=ArrayBuffer):(E.Float32Array=Array,E.Uint16Array=Array),E.INTERACTION_FREQUENCY=30,E.AUTO_PREVENT_DEFAULT=!0,E.PI_2=2*Math.PI,E.RAD_TO_DEG=180/Math.PI,E.DEG_TO_RAD=Math.PI/180,E.RETINA_PREFIX="@2x",E.dontSayHello=!1,E.defaultRenderOptions={view:null,transparent:!1,antialias:!1,preserveDrawingBuffer:!1,resolution:1,clearBeforeRender:!0,autoResize:!1},E.sayHello=function(t){},E.Point=function(t,e){this.x=t||0,this.y=e||0},E.Point.prototype.clone=function(){return new E.Point(this.x,this.y)},E.Point.prototype.set=function(t,e){this.x=t||0,this.y=e||(0!==e?this.x:0)},E.Point.prototype.constructor=E.Point,E.Rectangle=function(t,e,i,s){this.x=t||0,this.y=e||0,this.width=i||0,this.height=s||0},E.Rectangle.prototype.clone=function(){return new E.Rectangle(this.x,this.y,this.width,this.height)},E.Rectangle.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var i=this.x;if(i<=t&&t<=i+this.width){var s=this.y;if(s<=e&&e<=s+this.height)return!0}return!1},E.Rectangle.prototype.constructor=E.Rectangle,E.EmptyRectangle=new E.Rectangle(0,0,0,0),E.Polygon=function(t){if(t instanceof Array||(t=Array.prototype.slice.call(arguments)),t[0]instanceof E.Point){for(var e=[],i=0,s=t.length;i<s;i++)e.push(t[i].x,t[i].y);t=e}this.closed=!0,this.points=t},E.Polygon.prototype.clone=function(){var t=this.points.slice();return new E.Polygon(t)},E.Polygon.prototype.contains=function(t,e){for(var i=!1,s=this.points.length/2,r=0,n=s-1;r<s;n=r++){var o=this.points[2*r],h=this.points[2*r+1],a=this.points[2*n],l=this.points[2*n+1];e<h!=e<l&&t<(a-o)*(e-h)/(l-h)+o&&(i=!i)}return i},E.Polygon.prototype.constructor=E.Polygon,E.Circle=function(t,e,i){this.x=t||0,this.y=e||0,this.radius=i||0},E.Circle.prototype.clone=function(){return new E.Circle(this.x,this.y,this.radius)},E.Circle.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.x-t,s=this.y-e;return(i*=i)+(s*=s)<=this.radius*this.radius},E.Circle.prototype.getBounds=function(){return new E.Rectangle(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},E.Circle.prototype.constructor=E.Circle,E.Ellipse=function(t,e,i,s){this.x=t||0,this.y=e||0,this.width=i||0,this.height=s||0},E.Ellipse.prototype.clone=function(){return new E.Ellipse(this.x,this.y,this.width,this.height)},E.Ellipse.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,s=(e-this.y)/this.height;return(i*=i)+(s*=s)<=1},E.Ellipse.prototype.getBounds=function(){return new E.Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)},E.Ellipse.prototype.constructor=E.Ellipse,E.RoundedRectangle=function(t,e,i,s,r){this.x=t||0,this.y=e||0,this.width=i||0,this.height=s||0,this.radius=r||20},E.RoundedRectangle.prototype.clone=function(){return new E.RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)},E.RoundedRectangle.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var i=this.x;if(i<=t&&t<=i+this.width){var s=this.y;if(s<=e&&e<=s+this.height)return!0}return!1},E.RoundedRectangle.prototype.constructor=E.RoundedRectangle,E.Matrix=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0},E.Matrix.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},E.Matrix.prototype.toArray=function(t){this.array||(this.array=new E.Float32Array(9));var e=this.array;return t?(e[0]=this.a,e[1]=this.b,e[2]=0,e[3]=this.c,e[4]=this.d,e[5]=0,e[6]=this.tx,e[7]=this.ty):(e[0]=this.a,e[1]=this.c,e[2]=this.tx,e[3]=this.b,e[4]=this.d,e[5]=this.ty,e[6]=0,e[7]=0),e[8]=1,e},E.Matrix.prototype.apply=function(t,e){return(e=e||new E.Point).x=this.a*t.x+this.c*t.y+this.tx,e.y=this.b*t.x+this.d*t.y+this.ty,e},E.Matrix.prototype.applyInverse=function(t,e){e=e||new E.Point;var i=1/(this.a*this.d+this.c*-this.b);return e.x=this.d*i*t.x+-this.c*i*t.y+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*t.y+-this.b*i*t.x+(-this.ty*this.a+this.tx*this.b)*i,e},E.Matrix.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},E.Matrix.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},E.Matrix.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),s=this.a,r=this.c,n=this.tx;return this.a=s*e-this.b*i,this.b=s*i+this.b*e,this.c=r*e-this.d*i,this.d=r*i+this.d*e,this.tx=n*e-this.ty*i,this.ty=n*i+this.ty*e,this},E.Matrix.prototype.append=function(t){var e=this.a,i=this.b,s=this.c,r=this.d;return this.a=t.a*e+t.b*s,this.b=t.a*i+t.b*r,this.c=t.c*e+t.d*s,this.d=t.c*i+t.d*r,this.tx=t.tx*e+t.ty*s+this.tx,this.ty=t.tx*i+t.ty*r+this.ty,this},E.Matrix.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},E.identityMatrix=new E.Matrix,E.DisplayObject=function(){this.position=new E.Point,this.scale=new E.Point(1,1),this.pivot=new E.Point(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.hitArea=null,this.buttonMode=!1,this.renderable=!1,this.parent=null,this.stage=null,this.worldAlpha=1,this._interactive=!1,this.defaultCursor="pointer",this.worldTransform=new E.Matrix,this._sr=0,this._cr=1,this.filterArea=null,this._bounds=new E.Rectangle(0,0,1,1),this._currentBounds=null,this._mask=null,this._cacheAsBitmap=!1,this._cacheIsDirty=!1},E.DisplayObject.prototype.constructor=E.DisplayObject,Object.defineProperty(E.DisplayObject.prototype,"interactive",{get:function(){return this._interactive},set:function(t){this._interactive=t,this.stage&&(this.stage.dirty=!0)}}),Object.defineProperty(E.DisplayObject.prototype,"worldVisible",{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}}),Object.defineProperty(E.DisplayObject.prototype,"mask",{get:function(){return this._mask},set:function(t){this._mask&&(this._mask.isMask=!1),this._mask=t,this._mask&&(this._mask.isMask=!0)}}),Object.defineProperty(E.DisplayObject.prototype,"filters",{get:function(){return this._filters},set:function(t){if(t){for(var e=[],i=0;i<t.length;i++)for(var s=t[i].passes,r=0;r<s.length;r++)e.push(s[r]);this._filterBlock={target:this,filterPasses:e}}this._filters=t}}),Object.defineProperty(E.DisplayObject.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(t){this._cacheAsBitmap!==t&&(t?this._generateCachedSprite():this._destroyCachedSprite(),this._cacheAsBitmap=t)}}),E.DisplayObject.prototype.updateTransform=function(){var t,e,i,s,r,n,o=this.parent.worldTransform,h=this.worldTransform;this.rotation%E.PI_2?(this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation)),t=this._cr*this.scale.x,e=this._sr*this.scale.x,i=-this._sr*this.scale.y,s=this._cr*this.scale.y,r=this.position.x,n=this.position.y,(this.pivot.x||this.pivot.y)&&(r-=this.pivot.x*t+this.pivot.y*i,n-=this.pivot.x*e+this.pivot.y*s),h.a=t*o.a+e*o.c,h.b=t*o.b+e*o.d,h.c=i*o.a+s*o.c,h.d=i*o.b+s*o.d):(t=this.scale.x,s=this.scale.y,r=this.position.x-this.pivot.x*t,n=this.position.y-this.pivot.y*s,h.a=t*o.a,h.b=t*o.b,h.c=s*o.c,h.d=s*o.d),h.tx=r*o.a+n*o.c+o.tx,h.ty=r*o.b+n*o.d+o.ty,this.worldAlpha=this.alpha*this.parent.worldAlpha},E.DisplayObject.prototype.displayObjectUpdateTransform=E.DisplayObject.prototype.updateTransform,E.DisplayObject.prototype.getBounds=function(t){return E.EmptyRectangle},E.DisplayObject.prototype.getLocalBounds=function(){return this.getBounds(E.identityMatrix)},E.DisplayObject.prototype.setStageReference=function(t){this.stage=t,this._interactive&&(this.stage.dirty=!0)},E.DisplayObject.prototype.generateTexture=function(t,e,i){var s=this.getLocalBounds(),r=new E.RenderTexture(0|s.width,0|s.height,i,e,t);return E.DisplayObject._tempMatrix.tx=-s.x,E.DisplayObject._tempMatrix.ty=-s.y,r.render(this,E.DisplayObject._tempMatrix),r},E.DisplayObject.prototype.updateCache=function(){this._generateCachedSprite()},E.DisplayObject.prototype.toGlobal=function(t){return this.displayObjectUpdateTransform(),this.worldTransform.apply(t)},E.DisplayObject.prototype.toLocal=function(t,e){return e&&(t=e.toGlobal(t)),this.displayObjectUpdateTransform(),this.worldTransform.applyInverse(t)},E.DisplayObject.prototype._renderCachedSprite=function(t){this._cachedSprite.worldAlpha=this.worldAlpha,t.gl?E.Sprite.prototype._renderWebGL.call(this._cachedSprite,t):E.Sprite.prototype._renderCanvas.call(this._cachedSprite,t)},E.DisplayObject.prototype._generateCachedSprite=function(){this._cacheAsBitmap=!1;var t,e=this.getLocalBounds();this._cachedSprite?this._cachedSprite.texture.resize(0|e.width,0|e.height):(t=new E.RenderTexture(0|e.width,0|e.height),this._cachedSprite=new E.Sprite(t),this._cachedSprite.worldTransform=this.worldTransform);var i=this._filters;this._filters=null,this._cachedSprite.filters=i,E.DisplayObject._tempMatrix.tx=-e.x,E.DisplayObject._tempMatrix.ty=-e.y,this._cachedSprite.texture.render(this,E.DisplayObject._tempMatrix,!0),this._cachedSprite.anchor.x=-(e.x/e.width),this._cachedSprite.anchor.y=-(e.y/e.height),this._filters=i,this._cacheAsBitmap=!0},E.DisplayObject.prototype._destroyCachedSprite=function(){this._cachedSprite&&(this._cachedSprite.texture.destroy(!0),this._cachedSprite=null)},E.DisplayObject.prototype._renderWebGL=function(t){},E.DisplayObject.prototype._renderCanvas=function(t){},E.DisplayObject._tempMatrix=new E.Matrix,Object.defineProperty(E.DisplayObject.prototype,"x",{get:function(){return this.position.x},set:function(t){this.position.x=t}}),Object.defineProperty(E.DisplayObject.prototype,"y",{get:function(){return this.position.y},set:function(t){this.position.y=t}}),E.DisplayObjectContainer=function(){E.DisplayObject.call(this),this.children=[]},E.DisplayObjectContainer.prototype=Object.create(E.DisplayObject.prototype),E.DisplayObjectContainer.prototype.constructor=E.DisplayObjectContainer,Object.defineProperty(E.DisplayObjectContainer.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t}}),Object.defineProperty(E.DisplayObjectContainer.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t}}),E.DisplayObjectContainer.prototype.addChild=function(t){return this.addChildAt(t,this.children.length)},E.DisplayObjectContainer.prototype.addChildAt=function(t,e){if(0<=e&&e<=this.children.length)return t.parent&&t.parent.removeChild(t),(t.parent=this).children.splice(e,0,t),this.stage&&t.setStageReference(this.stage),t;throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length)},E.DisplayObjectContainer.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),s=this.getChildIndex(e);if(i<0||s<0)throw new Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.");this.children[i]=e,this.children[s]=t}},E.DisplayObjectContainer.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},E.DisplayObjectContainer.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The supplied index is out of bounds");var i=this.getChildIndex(t);this.children.splice(i,1),this.children.splice(e,0,t)},E.DisplayObjectContainer.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Supplied index "+t+" does not exist in the child list, or the supplied DisplayObject must be a child of the caller");return this.children[t]},E.DisplayObjectContainer.prototype.removeChild=function(t){var e=this.children.indexOf(t);if(-1!==e)return this.removeChildAt(e)},E.DisplayObjectContainer.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return this.stage&&e.removeStageReference(),e.parent=void 0,this.children.splice(t,1),e},E.DisplayObjectContainer.prototype.removeChildren=function(t,e){var i=t||0,s="number"==typeof e?e:this.children.length,r=s-i;if(0<r&&r<=s){for(var n=this.children.splice(i,r),o=0;o<n.length;o++){var h=n[o];this.stage&&h.removeStageReference(),h.parent=void 0}return n}if(0==r&&0===this.children.length)return[];throw new Error("removeChildren: Range Error, numeric values are outside the acceptable range")},E.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible&&(this.displayObjectUpdateTransform(),!this._cacheAsBitmap))for(var t=0,e=this.children.length;t<e;t++)this.children[t].updateTransform()},E.DisplayObjectContainer.prototype.displayObjectContainerUpdateTransform=E.DisplayObjectContainer.prototype.updateTransform,E.DisplayObjectContainer.prototype.getBounds=function(){if(0===this.children.length)return E.EmptyRectangle;for(var t,e,i,s=1/0,r=1/0,n=-1/0,o=-1/0,h=!1,a=0,l=this.children.length;a<l;a++){this.children[a].visible&&(h=!0,s=s<(t=this.children[a].getBounds()).x?s:t.x,r=r<t.y?r:t.y,n=(e=t.width+t.x)<n?n:e,o=(i=t.height+t.y)<o?o:i)}if(!h)return E.EmptyRectangle;var c=this._bounds;return c.x=s,c.y=r,c.width=n-s,c.height=o-r,c},E.DisplayObjectContainer.prototype.getLocalBounds=function(){var t=this.worldTransform;this.worldTransform=E.identityMatrix;for(var e=0,i=this.children.length;e<i;e++)this.children[e].updateTransform();var s=this.getBounds();return this.worldTransform=t,s},E.DisplayObjectContainer.prototype.setStageReference=function(t){this.stage=t,this._interactive&&(this.stage.dirty=!0);for(var e=0,i=this.children.length;e<i;e++){this.children[e].setStageReference(t)}},E.DisplayObjectContainer.prototype.removeStageReference=function(){for(var t=0,e=this.children.length;t<e;t++){this.children[t].removeStageReference()}this._interactive&&(this.stage.dirty=!0),this.stage=null},E.DisplayObjectContainer.prototype._renderWebGL=function(t){var e,i;if(this.visible&&!(this.alpha<=0))if(this._cacheAsBitmap)this._renderCachedSprite(t);else if(this._mask||this._filters){for(this._filters&&(t.spriteBatch.flush(),t.filterManager.pushFilter(this._filterBlock)),this._mask&&(t.spriteBatch.stop(),t.maskManager.pushMask(this.mask,t),t.spriteBatch.start()),e=0,i=this.children.length;e<i;e++)this.children[e]._renderWebGL(t);t.spriteBatch.stop(),this._mask&&t.maskManager.popMask(this._mask,t),this._filters&&t.filterManager.popFilter(),t.spriteBatch.start()}else for(e=0,i=this.children.length;e<i;e++)this.children[e]._renderWebGL(t)},E.DisplayObjectContainer.prototype._renderCanvas=function(t){if(!1!==this.visible&&0!==this.alpha)if(this._cacheAsBitmap)this._renderCachedSprite(t);else{this._mask&&t.maskManager.pushMask(this._mask,t);for(var e=0,i=this.children.length;e<i;e++){this.children[e]._renderCanvas(t)}this._mask&&t.maskManager.popMask(t)}},E.Sprite=function(t){E.DisplayObjectContainer.call(this),this.anchor=new E.Point,this.texture=t||E.Texture.emptyTexture,this._width=0,this._height=0,this.tint=16777215,this.blendMode=E.blendModes.NORMAL,this.shader=null,this.texture.baseTexture.hasLoaded?this.onTextureUpdate():this.texture.on("update",this.onTextureUpdate.bind(this)),this.renderable=!0},E.Sprite.prototype=Object.create(E.DisplayObjectContainer.prototype),E.Sprite.prototype.constructor=E.Sprite,Object.defineProperty(E.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.frame.width},set:function(t){this.scale.x=t/this.texture.frame.width,this._width=t}}),Object.defineProperty(E.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(t){this.scale.y=t/this.texture.frame.height,this._height=t}}),E.Sprite.prototype.setTexture=function(t){this.texture=t,this.cachedTint=16777215},E.Sprite.prototype.onTextureUpdate=function(){this._width&&(this.scale.x=this._width/this.texture.frame.width),this._height&&(this.scale.y=this._height/this.texture.frame.height)},E.Sprite.prototype.getBounds=function(t){var e,i,s,r,n,o,h,a,l=this.texture.frame.width,c=this.texture.frame.height,d=l*(1-this.anchor.x),u=l*-this.anchor.x,p=c*(1-this.anchor.y),f=c*-this.anchor.y,g=t||this.worldTransform,y=g.a,v=g.b,m=g.c,x=g.d,b=g.tx,T=g.ty,w=-1/0,C=-1/0,_=1/0,M=1/0,C=0===v&&0===m?(y<0&&(y*=-1),x<0&&(x*=-1),_=y*u+b,w=y*d+b,M=x*f+T,x*p+T):(_=(h=y*u+m*p+b)<(_=(n=y*d+m*p+b)<(_=(s=y*d+m*f+b)<(_=(e=y*u+m*f+b)<_?e:_)?s:_)?n:_)?h:_,M=(a=x*p+v*u+T)<(M=(o=x*p+v*d+T)<(M=(r=x*f+v*d+T)<(M=(i=x*f+v*u+T)<M?i:M)?r:M)?o:M)?a:M,w=(w=(w=(w=w<e?e:w)<s?s:w)<n?n:w)<h?h:w,(C=(C=(C=C<i?i:C)<r?r:C)<o?o:C)<a?a:C),E=this._bounds;return E.x=_,E.width=w-_,E.y=M,E.height=C-M,this._currentBounds=E},E.Sprite.prototype._renderWebGL=function(t){var e,i;if(this.visible&&!(this.alpha<=0))if(this._mask||this._filters){var s=t.spriteBatch;for(this._filters&&(s.flush(),t.filterManager.pushFilter(this._filterBlock)),this._mask&&(s.stop(),t.maskManager.pushMask(this.mask,t),s.start()),s.render(this),e=0,i=this.children.length;e<i;e++)this.children[e]._renderWebGL(t);s.stop(),this._mask&&t.maskManager.popMask(this._mask,t),this._filters&&t.filterManager.popFilter(),s.start()}else for(t.spriteBatch.render(this),e=0,i=this.children.length;e<i;e++)this.children[e]._renderWebGL(t)},E.Sprite.prototype._renderCanvas=function(t){if(!(!1===this.visible||0===this.alpha||this.texture.crop.width<=0||this.texture.crop.height<=0)){var e,i,s;this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,t.context.globalCompositeOperation=E.blendModesCanvas[t.currentBlendMode]),this._mask&&t.maskManager.pushMask(this._mask,t),this.texture.valid&&(e=this.texture.baseTexture.resolution/t.resolution,t.context.globalAlpha=this.worldAlpha,t.smoothProperty&&t.scaleMode!==this.texture.baseTexture.scaleMode&&(t.scaleMode=this.texture.baseTexture.scaleMode,t.context[t.smoothProperty]=t.scaleMode===E.scaleModes.LINEAR),i=this.texture.trim?this.texture.trim.x-this.anchor.x*this.texture.trim.width:this.anchor.x*-this.texture.frame.width,s=this.texture.trim?this.texture.trim.y-this.anchor.y*this.texture.trim.height:this.anchor.y*-this.texture.frame.height,t.roundPixels?(t.context.setTransform(this.worldTransform.a,this.worldTransform.b,this.worldTransform.c,this.worldTransform.d,this.worldTransform.tx*t.resolution|0,this.worldTransform.ty*t.resolution|0),i|=0,s|=0):t.context.setTransform(this.worldTransform.a,this.worldTransform.b,this.worldTransform.c,this.worldTransform.d,this.worldTransform.tx*t.resolution,this.worldTransform.ty*t.resolution),16777215!==this.tint?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=E.CanvasTinter.getTintedTexture(this,this.tint)),t.context.drawImage(this.tintedTexture,0,0,this.texture.crop.width,this.texture.crop.height,i/e,s/e,this.texture.crop.width/e,this.texture.crop.height/e)):t.context.drawImage(this.texture.baseTexture.source,this.texture.crop.x,this.texture.crop.y,this.texture.crop.width,this.texture.crop.height,i/e,s/e,this.texture.crop.width/e,this.texture.crop.height/e));for(var r=0,n=this.children.length;r<n;r++)this.children[r]._renderCanvas(t);this._mask&&t.maskManager.popMask(t)}},E.Sprite.fromFrame=function(t){var e=E.TextureCache[t];if(!e)throw new Error('The frameId "'+t+'" does not exist in the texture cache'+this);return new E.Sprite(e)},E.Sprite.fromImage=function(t,e,i){var s=E.Texture.fromImage(t,e,i);return new E.Sprite(s)},E.SpriteBatch=function(t){E.DisplayObjectContainer.call(this),this.textureThing=t,this.ready=!1},E.SpriteBatch.prototype=Object.create(E.DisplayObjectContainer.prototype),E.SpriteBatch.prototype.constructor=E.SpriteBatch,E.SpriteBatch.prototype.initWebGL=function(t){this.fastSpriteBatch=new E.WebGLFastSpriteBatch(t),this.ready=!0},E.SpriteBatch.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},E.SpriteBatch.prototype._renderWebGL=function(t){!this.visible||this.alpha<=0||!this.children.length||(this.ready||this.initWebGL(t.gl),this.fastSpriteBatch.gl!==t.gl&&this.fastSpriteBatch.setContext(t.gl),t.spriteBatch.stop(),t.shaderManager.setShader(t.shaderManager.fastShader),this.fastSpriteBatch.begin(this,t),this.fastSpriteBatch.render(this),t.spriteBatch.start())},E.SpriteBatch.prototype._renderCanvas=function(t){if(this.visible&&!(this.alpha<=0)&&this.children.length){var e=t.context;e.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var i=this.worldTransform,s=!0,r=0;r<this.children.length;r++){var n,o,h,a=this.children[r];a.visible&&(o=(n=a.texture).frame,e.globalAlpha=this.worldAlpha*a.alpha,a.rotation%(2*Math.PI)==0?(s&&(e.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty),s=!1),e.drawImage(n.baseTexture.source,o.x,o.y,o.width,o.height,a.anchor.x*(-o.width*a.scale.x)+a.position.x+.5|0,a.anchor.y*(-o.height*a.scale.y)+a.position.y+.5|0,o.width*a.scale.x,o.height*a.scale.y)):(s=s||!0,a.displayObjectUpdateTransform(),h=a.worldTransform,t.roundPixels?e.setTransform(h.a,h.b,h.c,h.d,0|h.tx,0|h.ty):e.setTransform(h.a,h.b,h.c,h.d,h.tx,h.ty),e.drawImage(n.baseTexture.source,o.x,o.y,o.width,o.height,a.anchor.x*-o.width+.5|0,a.anchor.y*-o.height+.5|0,o.width,o.height)))}}},E.MovieClip=function(t){E.Sprite.call(this,t[0]),this.textures=t,this.animationSpeed=1,this.loop=!0,this.onComplete=null,this.currentFrame=0,this.playing=!1},E.MovieClip.prototype=Object.create(E.Sprite.prototype),E.MovieClip.prototype.constructor=E.MovieClip,Object.defineProperty(E.MovieClip.prototype,"totalFrames",{get:function(){return this.textures.length}}),E.MovieClip.prototype.stop=function(){this.playing=!1},E.MovieClip.prototype.play=function(){this.playing=!0},E.MovieClip.prototype.gotoAndStop=function(t){this.playing=!1,this.currentFrame=t;var e=this.currentFrame+.5|0;this.setTexture(this.textures[e%this.textures.length])},E.MovieClip.prototype.gotoAndPlay=function(t){this.currentFrame=t,this.playing=!0},E.MovieClip.prototype.updateTransform=function(){var t;this.displayObjectContainerUpdateTransform(),this.playing&&(this.currentFrame+=this.animationSpeed,t=this.currentFrame+.5|0,this.currentFrame=this.currentFrame%this.textures.length,this.loop||t<this.textures.length?this.setTexture(this.textures[t%this.textures.length]):t>=this.textures.length&&(this.gotoAndStop(this.textures.length-1),this.onComplete&&this.onComplete()))},E.MovieClip.fromFrames=function(t){for(var e=[],i=0;i<t.length;i++)e.push(new E.Texture.fromFrame(t[i]));return new E.MovieClip(e)},E.MovieClip.fromImages=function(t){for(var e=[],i=0;i<t.length;i++)e.push(new E.Texture.fromImage(t[i]));return new E.MovieClip(e)},E.FilterBlock=function(){this.visible=!0,this.renderable=!0},E.FilterBlock.prototype.constructor=E.FilterBlock,E.Text=function(t,e){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=1,E.Sprite.call(this,E.Texture.fromCanvas(this.canvas)),this.setText(t),this.setStyle(e)},E.Text.prototype=Object.create(E.Sprite.prototype),E.Text.prototype.constructor=E.Text,Object.defineProperty(E.Text.prototype,"width",{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.x*this.texture.frame.width},set:function(t){this.scale.x=t/this.texture.frame.width,this._width=t}}),Object.defineProperty(E.Text.prototype,"height",{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.y*this.texture.frame.height},set:function(t){this.scale.y=t/this.texture.frame.height,this._height=t}}),E.Text.prototype.setStyle=function(t){(t=t||{}).font=t.font||"bold 20pt Arial",t.fill=t.fill||"black",t.align=t.align||"left",t.stroke=t.stroke||"black",t.strokeThickness=t.strokeThickness||0,t.wordWrap=t.wordWrap||!1,t.wordWrapWidth=t.wordWrapWidth||100,t.dropShadow=t.dropShadow||!1,t.dropShadowAngle=t.dropShadowAngle||Math.PI/6,t.dropShadowDistance=t.dropShadowDistance||4,t.dropShadowColor=t.dropShadowColor||"black",this.style=t,this.dirty=!0},E.Text.prototype.setText=function(t){this.text=t.toString()||" ",this.dirty=!0},E.Text.prototype.updateText=function(){this.texture.baseTexture.resolution=this.resolution,this.context.font=this.style.font;var t=this.text;this.style.wordWrap&&(t=this.wordWrap(this.text));for(var e=t.split(/(?:\r\n|\r|\n)/),i=[],s=0,r=this.determineFontProperties(this.style.font),n=0;n<e.length;n++){var o=this.context.measureText(e[n]).width;i[n]=o,s=Math.max(s,o)}var h=s+this.style.strokeThickness;this.style.dropShadow&&(h+=this.style.dropShadowDistance),this.canvas.width=(h+this.context.lineWidth)*this.resolution;var a,l,c=r.fontSize+this.style.strokeThickness,d=c*e.length;if(this.style.dropShadow&&(d+=this.style.dropShadowDistance),this.canvas.height=d*this.resolution,this.context.scale(this.resolution,this.resolution),navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.font=this.style.font,this.context.strokeStyle=this.style.stroke,this.context.lineWidth=this.style.strokeThickness,this.context.textBaseline="alphabetic",this.style.dropShadow){this.context.fillStyle=this.style.dropShadowColor;for(var u=Math.sin(this.style.dropShadowAngle)*this.style.dropShadowDistance,p=Math.cos(this.style.dropShadowAngle)*this.style.dropShadowDistance,n=0;n<e.length;n++)a=this.style.strokeThickness/2,l=this.style.strokeThickness/2+n*c+r.ascent,"right"===this.style.align?a+=s-i[n]:"center"===this.style.align&&(a+=(s-i[n])/2),this.style.fill&&this.context.fillText(e[n],a+u,l+p)}for(this.context.fillStyle=this.style.fill,n=0;n<e.length;n++)a=this.style.strokeThickness/2,l=this.style.strokeThickness/2+n*c+r.ascent,"right"===this.style.align?a+=s-i[n]:"center"===this.style.align&&(a+=(s-i[n])/2),this.style.stroke&&this.style.strokeThickness&&this.context.strokeText(e[n],a,l),this.style.fill&&this.context.fillText(e[n],a,l);this.updateTexture()},E.Text.prototype.updateTexture=function(){this.texture.baseTexture.width=this.canvas.width,this.texture.baseTexture.height=this.canvas.height,this.texture.crop.width=this.texture.frame.width=this.canvas.width,this.texture.crop.height=this.texture.frame.height=this.canvas.height,this._width=this.canvas.width,this._height=this.canvas.height,this.texture.baseTexture.dirty()},E.Text.prototype._renderWebGL=function(t){this.dirty&&(this.resolution=t.resolution,this.updateText(),this.dirty=!1),E.Sprite.prototype._renderWebGL.call(this,t)},E.Text.prototype._renderCanvas=function(t){this.dirty&&(this.resolution=t.resolution,this.updateText(),this.dirty=!1),E.Sprite.prototype._renderCanvas.call(this,t)},E.Text.prototype.determineFontProperties=function(t){var e=E.Text.fontPropertiesCache[t];if(!e){e={};var i=E.Text.fontPropertiesCanvas,s=E.Text.fontPropertiesContext;s.font=t;var r=Math.ceil(s.measureText("|Mq").width),n=2*(o=Math.ceil(s.measureText("M").width)),o=1.4*o|0;i.width=r,i.height=n,s.fillStyle="#f00",s.fillRect(0,0,r,n),s.font=t,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText("|M脡q",0,o);for(var h,a=s.getImageData(0,0,r,n).data,l=a.length,c=4*r,d=0,u=!1,p=0;p<o;p++){for(h=0;h<c;h+=4)if(255!==a[d+h]){u=!0;break}if(u)break;d+=c}for(e.ascent=o-p,d=l-c,u=!1,p=n;o<p;p--){for(h=0;h<c;h+=4)if(255!==a[d+h]){u=!0;break}if(u)break;d-=c}e.descent=p-o,e.descent+=6,e.fontSize=e.ascent+e.descent,E.Text.fontPropertiesCache[t]=e}return e},E.Text.prototype.wordWrap=function(t){for(var e="",i=t.split("\n"),s=0;s<i.length;s++){for(var r=this.style.wordWrapWidth,n=i[s].split(" "),o=0;o<n.length;o++){var h=this.context.measureText(n[o]).width,a=h+this.context.measureText(" ").width;0===o||r<a?(0<o&&(e+="\n"),e+=n[o],r=this.style.wordWrapWidth-h):(r-=a,e+=" "+n[o])}s<i.length-1&&(e+="\n")}return e},E.Text.prototype.getBounds=function(t){return this.dirty&&(this.updateText(),this.dirty=!1),E.Sprite.prototype.getBounds.call(this,t)},E.Text.prototype.destroy=function(t){this.context=null,this.canvas=null,this.texture.destroy(void 0===t||t)},E.Text.fontPropertiesCache={},E.Text.fontPropertiesCanvas=document.createElement("canvas"),E.Text.fontPropertiesContext=E.Text.fontPropertiesCanvas.getContext("2d"),E.InteractionData=function(){this.global=new E.Point,this.target=null,this.originalEvent=null},E.InteractionData.prototype.getLocalPosition=function(t,e){var i=t.worldTransform,s=this.global,r=i.a,n=i.c,o=i.tx,h=i.b,a=i.d,l=i.ty,c=1/(r*a+n*-h);return(e=e||new E.Point).x=a*c*s.x+-n*c*s.y+(l*n-o*a)*c,e.y=r*c*s.y+-h*c*s.x+(-l*r+o*h)*c,e},E.InteractionData.prototype.constructor=E.InteractionData,E.InteractionManager=function(t){this.stage=t,this.mouse=new E.InteractionData,this.touches={},this.tempPoint=new E.Point,this.mouseoverEnabled=!0,this.pool=[],this.interactiveItems=[],this.interactionDOMElement=null,this.onMouseMove=this.onMouseMove.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onTouchCancel=this.onTouchCancel.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.last=0,this.currentCursorStyle="inherit",this.mouseOut=!1,this.resolution=1,this._tempPoint=new E.Point},E.InteractionManager.prototype.constructor=E.InteractionManager,E.InteractionManager.prototype.collectInteractiveSprite=function(t,e){for(var i=t.children,s=i.length-1;0<=s;s--){var r=i[s];r._interactive?(e.interactiveChildren=!0,this.interactiveItems.push(r),0<r.children.length&&this.collectInteractiveSprite(r,r)):(r.__iParent=null,0<r.children.length&&this.collectInteractiveSprite(r,e))}},E.InteractionManager.prototype.setTarget=function(t){this.target=t,this.resolution=t.resolution,null===this.interactionDOMElement&&this.setTargetDomElement(t.view)},E.InteractionManager.prototype.setTargetDomElement=function(t){this.removeEvents(),window.navigator.msPointerEnabled&&(t.style["-ms-content-zooming"]="none",t.style["-ms-touch-action"]="none"),(this.interactionDOMElement=t).addEventListener("mousemove",this.onMouseMove,!0),t.addEventListener("mousedown",this.onMouseDown,!0),t.addEventListener("mouseout",this.onMouseOut,!0),t.addEventListener("touchstart",this.onTouchStart,!0),t.addEventListener("touchend",this.onTouchEnd,!0),t.addEventListener("touchleave",this.onTouchCancel,!0),t.addEventListener("touchcancel",this.onTouchCancel,!0),t.addEventListener("touchmove",this.onTouchMove,!0),window.addEventListener("mouseup",this.onMouseUp,!0)},E.InteractionManager.prototype.removeEvents=function(){this.interactionDOMElement&&(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]="",this.interactionDOMElement.removeEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.removeEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.removeEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.removeEventListener("touchleave",this.onTouchCancel,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onTouchCancel,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onTouchMove,!0),this.interactionDOMElement=null,window.removeEventListener("mouseup",this.onMouseUp,!0))},E.InteractionManager.prototype.update=function(){if(this.target){var t=Date.now();if(!((t-this.last)*E.INTERACTION_FREQUENCY/1e3<1)){this.last=t;var e=0;this.dirty&&this.rebuildInteractiveGraph();for(var i=this.interactiveItems.length,s="inherit",r=!1,e=0;e<i;e++){var n=this.interactiveItems[e];n.__hit=this.hitTest(n,this.mouse),(this.mouse.target=n).__hit&&!r?(n.buttonMode&&(s=n.defaultCursor),n.interactiveChildren||(r=!0),n.__isOver||(n.mouseover&&n.mouseover(this.mouse),n.__isOver=!0)):n.__isOver&&(n.mouseout&&n.mouseout(this.mouse),n.__isOver=!1)}this.currentCursorStyle!==s&&(this.currentCursorStyle=s,this.interactionDOMElement.style.cursor=s)}}},E.InteractionManager.prototype.rebuildInteractiveGraph=function(){this.dirty=!1;for(var t=this.interactiveItems.length,e=0;e<t;e++)this.interactiveItems[e].interactiveChildren=!1;this.interactiveItems=[],this.stage.interactive&&this.interactiveItems.push(this.stage),this.collectInteractiveSprite(this.stage,this.stage)},E.InteractionManager.prototype.onMouseMove=function(t){this.dirty&&this.rebuildInteractiveGraph(),this.mouse.originalEvent=t;var e=this.interactionDOMElement.getBoundingClientRect();this.mouse.global.x=(t.clientX-e.left)*(this.target.width/e.width)/this.resolution,this.mouse.global.y=(t.clientY-e.top)*(this.target.height/e.height)/this.resolution;for(var i=this.interactiveItems.length,s=0;s<i;s++){var r=this.interactiveItems[s];r.mousemove&&r.mousemove(this.mouse)}},E.InteractionManager.prototype.onMouseDown=function(t){this.dirty&&this.rebuildInteractiveGraph(),this.mouse.originalEvent=t,E.AUTO_PREVENT_DEFAULT&&this.mouse.originalEvent.preventDefault();for(var e=this.interactiveItems.length,i=this.mouse.originalEvent,s=2===i.button||3===i.which,r=s?"rightdown":"mousedown",n=s?"rightclick":"click",o=s?"__rightIsDown":"__mouseIsDown",h=s?"__isRightDown":"__isDown",a=0;a<e;a++){var l=this.interactiveItems[a];if((l[r]||l[n])&&(l[o]=!0,l.__hit=this.hitTest(l,this.mouse),l.__hit&&(l[r]&&l[r](this.mouse),l[h]=!0,!l.interactiveChildren)))break}},E.InteractionManager.prototype.onMouseOut=function(t){this.dirty&&this.rebuildInteractiveGraph(),this.mouse.originalEvent=t;var e=this.interactiveItems.length;this.interactionDOMElement.style.cursor="inherit";for(var i=0;i<e;i++){var s=this.interactiveItems[i];s.__isOver&&((this.mouse.target=s).mouseout&&s.mouseout(this.mouse),s.__isOver=!1)}this.mouseOut=!0,this.mouse.global.x=-1e4,this.mouse.global.y=-1e4},E.InteractionManager.prototype.onMouseUp=function(t){this.dirty&&this.rebuildInteractiveGraph(),this.mouse.originalEvent=t;for(var e=this.interactiveItems.length,i=!1,s=this.mouse.originalEvent,r=2===s.button||3===s.which,n=r?"rightup":"mouseup",o=r?"rightclick":"click",h=r?"rightupoutside":"mouseupoutside",a=r?"__isRightDown":"__isDown",l=0;l<e;l++){var c=this.interactiveItems[l];(c[o]||c[n]||c[h])&&(c.__hit=this.hitTest(c,this.mouse),c.__hit&&!i?(c[n]&&c[n](this.mouse),c[a]&&c[o]&&c[o](this.mouse),c.interactiveChildren||(i=!0)):c[a]&&c[h]&&c[h](this.mouse),c[a]=!1)}},E.InteractionManager.prototype.hitTest=function(t,e){var i=e.global;if(!t.worldVisible)return!1;t.worldTransform.applyInverse(i,this._tempPoint);var s=this._tempPoint.x,r=this._tempPoint.y;if((e.target=t).hitArea&&t.hitArea.contains)return t.hitArea.contains(s,r);if(t instanceof E.Sprite){var n,o=t.texture.frame.width,h=t.texture.frame.height,a=-o*t.anchor.x;if(a<s&&s<a+o&&(n=-h*t.anchor.y)<r&&r<n+h)return!0}else if(t instanceof E.Graphics)for(var l=t.graphicsData,c=0;c<l.length;c++){var d=l[c];if(d.fill&&(d.shape&&d.shape.contains(s,r)))return!0}var u=t.children.length;for(c=0;c<u;c++){var p=t.children[c];if(this.hitTest(p,e))return e.target=t,!0}return!1},E.InteractionManager.prototype.onTouchMove=function(t){this.dirty&&this.rebuildInteractiveGraph();for(var e=this.interactionDOMElement.getBoundingClientRect(),i=t.changedTouches,s=0,s=0;s<i.length;s++){var r,n=i[s];(r=this.touches[n.identifier]).originalEvent=t,r.global.x=(n.clientX-e.left)*(this.target.width/e.width)/this.resolution,r.global.y=(n.clientY-e.top)*(this.target.height/e.height)/this.resolution,!navigator.isCocoonJS||e.left||e.top||t.target.style.width||t.target.style.height||(r.global.x=n.clientX,r.global.y=n.clientY);for(var o=0;o<this.interactiveItems.length;o++){var h=this.interactiveItems[o];h.touchmove&&h.__touchData&&h.__touchData[n.identifier]&&h.touchmove(r)}}},E.InteractionManager.prototype.onTouchStart=function(t){this.dirty&&this.rebuildInteractiveGraph();var e=this.interactionDOMElement.getBoundingClientRect();E.AUTO_PREVENT_DEFAULT&&t.preventDefault();for(var i=t.changedTouches,s=0;s<i.length;s++){var r=i[s],n=this.pool.pop();(n=n||new E.InteractionData).originalEvent=t,(this.touches[r.identifier]=n).global.x=(r.clientX-e.left)*(this.target.width/e.width)/this.resolution,n.global.y=(r.clientY-e.top)*(this.target.height/e.height)/this.resolution,!navigator.isCocoonJS||e.left||e.top||t.target.style.width||t.target.style.height||(n.global.x=r.clientX,n.global.y=r.clientY);for(var o=this.interactiveItems.length,h=0;h<o;h++){var a=this.interactiveItems[h];if((a.touchstart||a.tap)&&(a.__hit=this.hitTest(a,n),a.__hit&&(a.touchstart&&a.touchstart(n),a.__isDown=!0,a.__touchData=a.__touchData||{},a.__touchData[r.identifier]=n,!a.interactiveChildren)))break}}},E.InteractionManager.prototype.onTouchEnd=function(t){this.dirty&&this.rebuildInteractiveGraph();for(var e=this.interactionDOMElement.getBoundingClientRect(),i=t.changedTouches,s=0;s<i.length;s++){var r=i[s],n=this.touches[r.identifier],o=!1;n.global.x=(r.clientX-e.left)*(this.target.width/e.width)/this.resolution,n.global.y=(r.clientY-e.top)*(this.target.height/e.height)/this.resolution,!navigator.isCocoonJS||e.left||e.top||t.target.style.width||t.target.style.height||(n.global.x=r.clientX,n.global.y=r.clientY);for(var h=this.interactiveItems.length,a=0;a<h;a++){var l=this.interactiveItems[a];l.__touchData&&l.__touchData[r.identifier]&&(l.__hit=this.hitTest(l,l.__touchData[r.identifier]),n.originalEvent=t,(l.touchend||l.tap)&&(l.__hit&&!o?(l.touchend&&l.touchend(n),l.__isDown&&l.tap&&l.tap(n),l.interactiveChildren||(o=!0)):l.__isDown&&l.touchendoutside&&l.touchendoutside(n),l.__isDown=!1),l.__touchData[r.identifier]=null)}this.pool.push(n),this.touches[r.identifier]=null}},E.InteractionManager.prototype.onTouchCancel=function(t){this.dirty&&this.rebuildInteractiveGraph();for(var e=this.interactionDOMElement.getBoundingClientRect(),i=t.changedTouches,s=0;s<i.length;s++){var r=i[s],n=this.touches[r.identifier],o=!1;n.global.x=(r.clientX-e.left)*(this.target.width/e.width)/this.resolution,n.global.y=(r.clientY-e.top)*(this.target.height/e.height)/this.resolution,!navigator.isCocoonJS||e.left||e.top||t.target.style.width||t.target.style.height||(n.global.x=r.clientX,n.global.y=r.clientY);for(var h=this.interactiveItems.length,a=0;a<h;a++){var l=this.interactiveItems[a];l.__touchData&&l.__touchData[r.identifier]&&(l.__hit=this.hitTest(l,l.__touchData[r.identifier]),n.originalEvent=t,l.touchcancel&&!o&&(l.touchcancel(n),l.interactiveChildren||(o=!0)),l.__isDown=!1,l.__touchData[r.identifier]=null)}this.pool.push(n),this.touches[r.identifier]=null}},E.Stage=function(t){E.DisplayObjectContainer.call(this),this.worldTransform=new E.Matrix,this.interactive=!0,this.interactionManager=new E.InteractionManager(this),this.dirty=!0,(this.stage=this).stage.hitArea=new E.Rectangle(0,0,1e5,1e5),this.setBackgroundColor(t)},E.Stage.prototype=Object.create(E.DisplayObjectContainer.prototype),E.Stage.prototype.constructor=E.Stage,E.Stage.prototype.setInteractionDelegate=function(t){this.interactionManager.setTargetDomElement(t)},E.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var t=0,e=this.children.length;t<e;t++)this.children[t].updateTransform();this.dirty&&(this.dirty=!1,this.interactionManager.dirty=!0),this.interactive&&this.interactionManager.update()},E.Stage.prototype.setBackgroundColor=function(t){this.backgroundColor=t||0,this.backgroundColorSplit=E.hex2rgb(this.backgroundColor);var e=this.backgroundColor.toString(16),e="000000".substr(0,6-e.length)+e;this.backgroundColorString="#"+e},E.Stage.prototype.getMousePosition=function(){return this.interactionManager.mouse.global},function(r){for(var n=0,t=["ms","moz","webkit","o"],e=0;e<t.length&&!r.requestAnimationFrame;++e)r.requestAnimationFrame=r[t[e]+"RequestAnimationFrame"],r.cancelAnimationFrame=r[t[e]+"CancelAnimationFrame"]||r[t[e]+"CancelRequestAnimationFrame"];r.requestAnimationFrame||(r.requestAnimationFrame=function(t){var e=(new Date).getTime(),i=Math.max(0,16-(e-n)),s=r.setTimeout(function(){t(e+i)},i);return n=e+i,s}),r.cancelAnimationFrame||(r.cancelAnimationFrame=function(t){clearTimeout(t)}),r.requestAnimFrame=r.requestAnimationFrame}(this),E.hex2rgb=function(t){return[(t>>16&255)/255,(t>>8&255)/255,(255&t)/255]},E.rgb2hex=function(t){return(255*t[0]<<16)+(255*t[1]<<8)+255*t[2]},"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(i){var s=this,t=arguments.length-1,r=[];if(0<t)for(r.length=t;t--;)r[t]=arguments[t+1];if("function"!=typeof s)throw new TypeError;function n(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return e=r.concat(e),s.apply(this instanceof n?this:i,e)}return n.prototype=function t(e){if(e&&(t.prototype=e),!(this instanceof t))return new t}(s.prototype),n}),E.AjaxRequest=function(){var t=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"];if(!window.ActiveXObject)return!!window.XMLHttpRequest&&new window.XMLHttpRequest;for(var e=0;e<t.length;e++)try{return new window.ActiveXObject(t[e])}catch(t){}},E.canUseNewCanvasBlendModes=function(){if("undefined"==typeof document)return!1;var t=document.createElement("canvas");t.width=1,t.height=1;var e=t.getContext("2d");return e.fillStyle="#000",e.fillRect(0,0,1,1),e.globalCompositeOperation="multiply",e.fillStyle="#fff",e.fillRect(0,0,1,1),0===e.getImageData(0,0,1,1).data[0]},E.getNextPowerOfTwo=function(t){if(0<t&&0==(t&t-1))return t;for(var e=1;e<t;)e<<=1;return e},E.isPowerOfTwo=function(t,e){return 0<t&&0==(t&t-1)&&0<e&&0==(e&e-1)},E.EventTarget={call:function(t){t&&(t=t.prototype||t,E.EventTarget.mixin(t))},mixin:function(t){t.listeners=function(t){return this._listeners=this._listeners||{},this._listeners[t]?this._listeners[t].slice():[]},t.emit=t.dispatchEvent=function(t,e){if(this._listeners=this._listeners||{},"object"==typeof t&&(t=(e=t).type),e&&!0===e.__isEventObject||(e=new E.Event(this,t,e)),this._listeners&&this._listeners[t]){for(var i=this._listeners[t].slice(0),s=i.length,r=i[0],n=0;n<s;r=i[++n])if(r.call(this,e),e.stoppedImmediate)return this;if(e.stopped)return this}return this.parent&&this.parent.emit&&this.parent.emit.call(this.parent,t,e),this},t.on=t.addEventListener=function(t,e){return this._listeners=this._listeners||{},(this._listeners[t]=this._listeners[t]||[]).push(e),this},t.once=function(t,e){this._listeners=this._listeners||{};var i=this;function s(){e.apply(i.off(t,s),arguments)}return s._originalHandler=e,this.on(t,s)},t.off=t.removeEventListener=function(t,e){if(this._listeners=this._listeners||{},!this._listeners[t])return this;for(var i=this._listeners[t],s=e?i.length:0;0<s--;)i[s]!==e&&i[s]._originalHandler!==e||i.splice(s,1);return 0===i.length&&delete this._listeners[t],this},t.removeAllListeners=function(t){return this._listeners=this._listeners||{},this._listeners[t]&&delete this._listeners[t],this}}},E.Event=function(t,e,i){this.__isEventObject=!0,this.stopped=!1,this.stoppedImmediate=!1,this.target=t,this.type=e,this.data=i,this.content=i,this.timeStamp=Date.now()},E.Event.prototype.stopPropagation=function(){this.stopped=!0},E.Event.prototype.stopImmediatePropagation=function(){this.stoppedImmediate=!0},E.autoDetectRenderer=function(t,e,i){return t=t||800,e=e||600,new E.CanvasRenderer(t,e,i)},E.autoDetectRecommendedRenderer=function(t,e,i){return t=t||800,e=e||600,new E.CanvasRenderer(t,e,i)},E.PolyK={},E.PolyK.Triangulate=function(t){var e=!0,i=t.length>>1;if(i<3)return[];for(var s=[],r=[],n=0;n<i;n++)r.push(n);n=0;for(var o=i;3<o;){var h=r[(n+0)%o],a=r[(n+1)%o],l=r[(n+2)%o],c=t[2*h],d=t[2*h+1],u=t[2*a],p=t[2*a+1],f=t[2*l],g=t[2*l+1],y=!1;if(E.PolyK._convex(c,d,u,p,f,g,e)){y=!0;for(var v=0;v<o;v++){var m=r[v];if(m!==h&&m!==a&&m!==l&&E.PolyK._PointInTriangle(t[2*m],t[2*m+1],c,d,u,p,f,g)){y=!1;break}}}if(y)s.push(h,a,l),r.splice((n+1)%o,1),o--,n=0;else if(n++>3*o){if(!e)return null;for(s=[],r=[],n=0;n<i;n++)r.push(n);n=0,o=i,e=!1}}return s.push(r[0],r[1],r[2]),s},E.PolyK._PointInTriangle=function(t,e,i,s,r,n,o,h){var a=o-i,l=h-s,c=r-i,d=n-s,u=t-i,p=e-s,f=a*a+l*l,g=a*c+l*d,y=a*u+l*p,v=c*c+d*d,m=c*u+d*p,x=1/(f*v-g*g),b=(v*y-g*m)*x,T=(f*m-g*y)*x;return 0<=b&&0<=T&&b+T<1},E.PolyK._convex=function(t,e,i,s,r,n,o){return 0<=(e-s)*(r-i)+(i-t)*(n-s)===o},E.CanvasBuffer=function(t,e){this.width=t,this.height=e,this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=t,this.canvas.height=e},E.CanvasBuffer.prototype.constructor=E.CanvasBuffer,E.CanvasBuffer.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.width,this.height)},E.CanvasBuffer.prototype.resize=function(t,e){this.width=this.canvas.width=t,this.height=this.canvas.height=e},E.CanvasMaskManager=function(){},E.CanvasMaskManager.prototype.constructor=E.CanvasMaskManager,E.CanvasMaskManager.prototype.pushMask=function(t,e){var i=e.context;i.save();var s=t.alpha,r=t.worldTransform,n=e.resolution;i.setTransform(r.a*n,r.b*n,r.c*n,r.d*n,r.tx*n,r.ty*n),E.CanvasGraphics.renderGraphicsMask(t,i),i.clip(),t.worldAlpha=s},E.CanvasMaskManager.prototype.popMask=function(t){t.context.restore()},E.CanvasTinter=function(){},E.CanvasTinter.getTintedTexture=function(t,e){var i=t.texture,s="#"+("00000"+(0|(e=E.CanvasTinter.roundColor(e))).toString(16)).substr(-6);if(i.tintCache=i.tintCache||{},i.tintCache[s])return i.tintCache[s];var r,n=E.CanvasTinter.canvas||document.createElement("canvas");return E.CanvasTinter.tintMethod(i,e,n),E.CanvasTinter.convertTintToImage?((r=new Image).src=n.toDataURL(),i.tintCache[s]=r):(i.tintCache[s]=n,E.CanvasTinter.canvas=null),n},E.CanvasTinter.tintWithMultiply=function(t,e,i){var s=i.getContext("2d"),r=t.crop;i.width=r.width,i.height=r.height,s.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),s.fillRect(0,0,r.width,r.height),s.globalCompositeOperation="multiply",s.drawImage(t.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height),s.globalCompositeOperation="destination-atop",s.drawImage(t.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height)},E.CanvasTinter.tintWithOverlay=function(t,e,i){var s=i.getContext("2d"),r=t.crop;i.width=r.width,i.height=r.height,s.globalCompositeOperation="copy",s.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),s.fillRect(0,0,r.width,r.height),s.globalCompositeOperation="destination-atop",s.drawImage(t.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height)},E.CanvasTinter.tintWithPerPixel=function(t,e,i){var s=i.getContext("2d"),r=t.crop;i.width=r.width,i.height=r.height,s.globalCompositeOperation="copy",s.drawImage(t.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height);for(var n=E.hex2rgb(e),o=n[0],h=n[1],a=n[2],l=s.getImageData(0,0,r.width,r.height),c=l.data,d=0;d<c.length;d+=4)c[d+0]*=o,c[d+1]*=h,c[d+2]*=a;s.putImageData(l,0,0)},E.CanvasTinter.roundColor=function(t){var e=E.CanvasTinter.cacheStepsPerColorChannel,i=E.hex2rgb(t);return i[0]=Math.min(255,i[0]/e*e),i[1]=Math.min(255,i[1]/e*e),i[2]=Math.min(255,i[2]/e*e),E.rgb2hex(i)},E.CanvasTinter.cacheStepsPerColorChannel=8,E.CanvasTinter.convertTintToImage=!1,E.CanvasTinter.canUseMultiply=E.canUseNewCanvasBlendModes(),E.CanvasTinter.tintMethod=E.CanvasTinter.canUseMultiply?E.CanvasTinter.tintWithMultiply:E.CanvasTinter.tintWithPerPixel,E.CanvasRenderer=function(t,e,i){if(i)for(var s in E.defaultRenderOptions)void 0===i[s]&&(i[s]=E.defaultRenderOptions[s]);else i=E.defaultRenderOptions;E.defaultRenderer||(E.sayHello("Canvas"),E.defaultRenderer=this),this.type=E.CANVAS_RENDERER,this.resolution=i.resolution,this.clearBeforeRender=i.clearBeforeRender,this.transparent=i.transparent,this.autoResize=i.autoResize||!1,this.width=t||800,this.height=e||600,this.width*=this.resolution,this.height*=this.resolution,this.view=i.view||document.createElement("canvas"),this.context=this.view.getContext("2d",{alpha:this.transparent}),this.refresh=!0,this.view.width=this.width*this.resolution,this.view.height=this.height*this.resolution,this.count=0,this.maskManager=new E.CanvasMaskManager,this.renderSession={context:this.context,maskManager:this.maskManager,scaleMode:null,smoothProperty:null,roundPixels:!1},this.mapBlendModes(),this.resize(t,e),"imageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="imageSmoothingEnabled":"webkitImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="webkitImageSmoothingEnabled":"mozImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="mozImageSmoothingEnabled":"oImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="oImageSmoothingEnabled":"msImageSmoothingEnabled"in this.context&&(this.renderSession.smoothProperty="msImageSmoothingEnabled")},E.CanvasRenderer.prototype.constructor=E.CanvasRenderer,E.CanvasRenderer.prototype.render=function(t){t.updateTransform(),this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1,this.renderSession.currentBlendMode=E.blendModes.NORMAL,this.context.globalCompositeOperation=E.blendModesCanvas[E.blendModes.NORMAL],navigator.isCocoonJS&&this.view.screencanvas&&(this.context.fillStyle="black",this.context.clear()),this.clearBeforeRender&&(this.transparent?this.context.clearRect(0,0,this.width,this.height):(this.context.fillStyle=t.backgroundColorString,this.context.fillRect(0,0,this.width,this.height))),this.renderDisplayObject(t),t.interactive&&(t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this)))},E.CanvasRenderer.prototype.destroy=function(t){void 0===t&&(t=!0),t&&this.view.parent&&this.view.parent.removeChild(this.view),this.view=null,this.context=null,this.maskManager=null,this.renderSession=null},E.CanvasRenderer.prototype.resize=function(t,e){this.width=t*this.resolution,this.height=e*this.resolution,this.view.width=this.width,this.view.height=this.height,this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px")},E.CanvasRenderer.prototype.renderDisplayObject=function(t,e){this.renderSession.context=e||this.context,this.renderSession.resolution=this.resolution,t._renderCanvas(this.renderSession)},E.CanvasRenderer.prototype.mapBlendModes=function(){E.blendModesCanvas||(E.blendModesCanvas=[],E.canUseNewCanvasBlendModes()?(E.blendModesCanvas[E.blendModes.NORMAL]="source-over",E.blendModesCanvas[E.blendModes.ADD]="lighter",E.blendModesCanvas[E.blendModes.MULTIPLY]="multiply",E.blendModesCanvas[E.blendModes.SCREEN]="screen",E.blendModesCanvas[E.blendModes.OVERLAY]="overlay",E.blendModesCanvas[E.blendModes.DARKEN]="darken",E.blendModesCanvas[E.blendModes.LIGHTEN]="lighten",E.blendModesCanvas[E.blendModes.COLOR_DODGE]="color-dodge",E.blendModesCanvas[E.blendModes.COLOR_BURN]="color-burn",E.blendModesCanvas[E.blendModes.HARD_LIGHT]="hard-light",E.blendModesCanvas[E.blendModes.SOFT_LIGHT]="soft-light",E.blendModesCanvas[E.blendModes.DIFFERENCE]="difference",E.blendModesCanvas[E.blendModes.EXCLUSION]="exclusion",E.blendModesCanvas[E.blendModes.HUE]="hue",E.blendModesCanvas[E.blendModes.SATURATION]="saturation",E.blendModesCanvas[E.blendModes.COLOR]="color",E.blendModesCanvas[E.blendModes.LUMINOSITY]="luminosity"):(E.blendModesCanvas[E.blendModes.NORMAL]="source-over",E.blendModesCanvas[E.blendModes.ADD]="lighter",E.blendModesCanvas[E.blendModes.MULTIPLY]="source-over",E.blendModesCanvas[E.blendModes.SCREEN]="source-over",E.blendModesCanvas[E.blendModes.OVERLAY]="source-over",E.blendModesCanvas[E.blendModes.DARKEN]="source-over",E.blendModesCanvas[E.blendModes.LIGHTEN]="source-over",E.blendModesCanvas[E.blendModes.COLOR_DODGE]="source-over",E.blendModesCanvas[E.blendModes.COLOR_BURN]="source-over",E.blendModesCanvas[E.blendModes.HARD_LIGHT]="source-over",E.blendModesCanvas[E.blendModes.SOFT_LIGHT]="source-over",E.blendModesCanvas[E.blendModes.DIFFERENCE]="source-over",E.blendModesCanvas[E.blendModes.EXCLUSION]="source-over",E.blendModesCanvas[E.blendModes.HUE]="source-over",E.blendModesCanvas[E.blendModes.SATURATION]="source-over",E.blendModesCanvas[E.blendModes.COLOR]="source-over",E.blendModesCanvas[E.blendModes.LUMINOSITY]="source-over"))},E.CanvasGraphics=function(){},E.CanvasGraphics.renderGraphics=function(t,e){var i=t.worldAlpha;t.dirty&&(this.updateGraphicsTint(t),t.dirty=!1);for(var s=0;s<t.graphicsData.length;s++){var r,n,o,h,a,l,c,d,u,p,f,g,y,v,m,x,b=t.graphicsData[s],T=b.shape,w=b._fillTint,C=b._lineTint;if(e.lineWidth=b.lineWidth,b.type===E.Graphics.POLY){e.beginPath();var _=T.points;e.moveTo(_[0],_[1]);for(var M=1;M<_.length/2;M++)e.lineTo(_[2*M],_[2*M+1]);T.closed&&e.lineTo(_[0],_[1]),_[0]===_[_.length-2]&&_[1]===_[_.length-1]&&e.closePath(),b.fill&&(e.globalAlpha=b.fillAlpha*i,e.fillStyle="#"+("00000"+(0|w).toString(16)).substr(-6),e.fill()),b.lineWidth&&(e.globalAlpha=b.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|C).toString(16)).substr(-6),e.stroke())}else{b.type===E.Graphics.RECT?(!b.fillColor&&0!==b.fillColor||(e.globalAlpha=b.fillAlpha*i,e.fillStyle="#"+("00000"+(0|w).toString(16)).substr(-6),e.fillRect(T.x,T.y,T.width,T.height)),b.lineWidth&&(e.globalAlpha=b.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|C).toString(16)).substr(-6),e.strokeRect(T.x,T.y,T.width,T.height))):b.type===E.Graphics.CIRC?(e.beginPath(),e.arc(T.x,T.y,T.radius,0,2*Math.PI),e.closePath(),b.fill&&(e.globalAlpha=b.fillAlpha*i,e.fillStyle="#"+("00000"+(0|w).toString(16)).substr(-6),e.fill()),b.lineWidth&&(e.globalAlpha=b.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|C).toString(16)).substr(-6),e.stroke())):b.type===E.Graphics.ELIP?(r=2*T.width,n=2*T.height,o=T.x-r/2,h=T.y-n/2,e.beginPath(),a=r/2*.5522848,l=n/2*.5522848,c=o+r,d=h+n,u=o+r/2,p=h+n/2,e.moveTo(o,p),e.bezierCurveTo(o,p-l,u-a,h,u,h),e.bezierCurveTo(u+a,h,c,p-l,c,p),e.bezierCurveTo(c,p+l,u+a,d,u,d),e.bezierCurveTo(u-a,d,o,p+l,o,p),e.closePath(),b.fill&&(e.globalAlpha=b.fillAlpha*i,e.fillStyle="#"+("00000"+(0|w).toString(16)).substr(-6),e.fill()),b.lineWidth&&(e.globalAlpha=b.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|C).toString(16)).substr(-6),e.stroke())):b.type===E.Graphics.RREC&&(f=T.x,g=T.y,y=T.width,v=T.height,x=T.radius,x=(m=Math.min(y,v)/2|0)<x?m:x,e.beginPath(),e.moveTo(f,g+x),e.lineTo(f,g+v-x),e.quadraticCurveTo(f,g+v,f+x,g+v),e.lineTo(f+y-x,g+v),e.quadraticCurveTo(f+y,g+v,f+y,g+v-x),e.lineTo(f+y,g+x),e.quadraticCurveTo(f+y,g,f+y-x,g),e.lineTo(f+x,g),e.quadraticCurveTo(f,g,f,g+x),e.closePath(),!b.fillColor&&0!==b.fillColor||(e.globalAlpha=b.fillAlpha*i,e.fillStyle="#"+("00000"+(0|w).toString(16)).substr(-6),e.fill()),b.lineWidth&&(e.globalAlpha=b.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|C).toString(16)).substr(-6),e.stroke()))}}},E.CanvasGraphics.renderGraphicsMask=function(t,e){var i=t.graphicsData.length;if(0!==i){1<i&&window.console.log("Pixi.js warning: masks in canvas can only mask using the first path in the graphics object");for(var s=0;s<1;s++){var r,n,o,h,a,l,c,d,u,p,f,g,y,v,m,x,b,T=t.graphicsData[s],w=T.shape;if(T.type===E.Graphics.POLY){e.beginPath();var C=w.points;e.moveTo(C[0],C[1]);for(var _=1;_<C.length/2;_++)e.lineTo(C[2*_],C[2*_+1]);C[0]===C[C.length-2]&&C[1]===C[C.length-1]&&e.closePath()}else{T.type===E.Graphics.RECT?(e.beginPath(),e.rect(w.x,w.y,w.width,w.height),e.closePath()):T.type===E.Graphics.CIRC?(e.beginPath(),e.arc(w.x,w.y,w.radius,0,2*Math.PI),e.closePath()):T.type===E.Graphics.ELIP?(r=2*w.width,n=2*w.height,o=w.x-r/2,h=w.y-n/2,e.beginPath(),a=r/2*.5522848,l=n/2*.5522848,c=o+r,d=h+n,u=o+r/2,p=h+n/2,e.moveTo(o,p),e.bezierCurveTo(o,p-l,u-a,h,u,h),e.bezierCurveTo(u+a,h,c,p-l,c,p),e.bezierCurveTo(c,p+l,u+a,d,u,d),e.bezierCurveTo(u-a,d,o,p+l,o,p),e.closePath()):T.type===E.Graphics.RREC&&(g=(f=w.points)[0],y=f[1],v=f[2],m=f[3],b=f[4],b=(x=Math.min(v,m)/2|0)<b?x:b,e.beginPath(),e.moveTo(g,y+b),e.lineTo(g,y+m-b),e.quadraticCurveTo(g,y+m,g+b,y+m),e.lineTo(g+v-b,y+m),e.quadraticCurveTo(g+v,y+m,g+v,y+m-b),e.lineTo(g+v,y+b),e.quadraticCurveTo(g+v,y,g+v-b,y),e.lineTo(g+b,y),e.quadraticCurveTo(g,y,g,y+b),e.closePath())}}}},E.CanvasGraphics.updateGraphicsTint=function(t){if(16777215!==t.tint)for(var e=(t.tint>>16&255)/255,i=(t.tint>>8&255)/255,s=(255&t.tint)/255,r=0;r<t.graphicsData.length;r++){var n=t.graphicsData[r],o=0|n.fillColor,h=0|n.lineColor;n._fillTint=((o>>16&255)/255*e*255<<16)+((o>>8&255)/255*i*255<<8)+(255&o)/255*s*255,n._lineTint=((h>>16&255)/255*e*255<<16)+((h>>8&255)/255*i*255<<8)+(255&h)/255*s*255}},E.BaseTextureCache={},E.BaseTextureCacheIdGenerator=0,E.BaseTexture=function(t,e){var i;this.resolution=1,this.width=100,this.height=100,this.scaleMode=e||E.scaleModes.DEFAULT,this.hasLoaded=!1,this.source=t,this._UID=E._UID++,this.premultipliedAlpha=!0,this._glTextures=[],this.mipmap=!1,this._dirty=[!0,!0,!0,!0],t&&((this.source.complete||this.source.getContext)&&this.source.width&&this.source.height?(this.hasLoaded=!0,this.width=this.source.naturalWidth||this.source.width,this.height=this.source.naturalHeight||this.source.height,this.dirty()):((i=this).source.onload=function(){i.hasLoaded=!0,i.width=i.source.naturalWidth||i.source.width,i.height=i.source.naturalHeight||i.source.height,i.dirty(),i.dispatchEvent({type:"loaded",content:i})},this.source.onerror=function(){i.dispatchEvent({type:"error",content:i})}),this.imageUrl=null,this._powerOf2=!1)},E.BaseTexture.prototype.constructor=E.BaseTexture,E.EventTarget.mixin(E.BaseTexture.prototype),E.BaseTexture.prototype.destroy=function(){this.imageUrl?(delete E.BaseTextureCache[this.imageUrl],delete E.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src="")):this.source&&this.source._pixiId&&delete E.BaseTextureCache[this.source._pixiId],this.source=null,this.unloadFromGPU()},E.BaseTexture.prototype.updateSourceImage=function(t){this.hasLoaded=!1,this.source.src=null,this.source.src=t},E.BaseTexture.prototype.dirty=function(){for(var t=0;t<this._glTextures.length;t++)this._dirty[t]=!0},E.BaseTexture.prototype.unloadFromGPU=function(){this.dirty();for(var t=this._glTextures.length-1;0<=t;t--){var e=this._glTextures[t],i=E.glContexts[t];i&&e&&i.deleteTexture(e)}this._glTextures.length=0,this.dirty()},E.BaseTexture.fromImage=function(t,e,i){var s,r=E.BaseTextureCache[t];return void 0===e&&-1===t.indexOf("data:")&&(e=!0),r||(s=new Image,e&&(s.crossOrigin=""),s.src=t,(r=new E.BaseTexture(s,i)).imageUrl=t,E.BaseTextureCache[t]=r,-1!==t.indexOf(E.RETINA_PREFIX+".")&&(r.resolution=2)),r},E.BaseTexture.fromCanvas=function(t,e){t._pixiId||(t._pixiId="canvas_"+E.TextureCacheIdGenerator++);var i=E.BaseTextureCache[t._pixiId];return i||(i=new E.BaseTexture(t,e),E.BaseTextureCache[t._pixiId]=i),i},E.TextureCache={},E.FrameCache={},E.TextureCacheIdGenerator=0,E.Texture=function(t,e,i,s){this.noFrame=!1,e||(this.noFrame=!0,e=new E.Rectangle(0,0,1,1)),t instanceof E.Texture&&(t=t.baseTexture),this.baseTexture=t,this.frame=e,this.trim=s,this.valid=!1,this.requiresUpdate=!1,this._uvs=null,this.width=0,this.height=0,this.crop=i||new E.Rectangle(0,0,1,1),t.hasLoaded?(this.noFrame&&(e=new E.Rectangle(0,0,t.width,t.height)),this.setFrame(e)):t.addEventListener("loaded",this.onBaseTextureLoaded.bind(this))},E.Texture.prototype.constructor=E.Texture,E.EventTarget.mixin(E.Texture.prototype),E.Texture.prototype.onBaseTextureLoaded=function(){var t=this.baseTexture;t.removeEventListener("loaded",this.onLoaded),this.noFrame&&(this.frame=new E.Rectangle(0,0,t.width,t.height)),this.setFrame(this.frame),this.dispatchEvent({type:"update",content:this})},E.Texture.prototype.destroy=function(t){t&&this.baseTexture.destroy(),this.valid=!1},E.Texture.prototype.setFrame=function(t){if(this.noFrame=!1,this.frame=t,this.width=t.width,this.height=t.height,this.crop.x=t.x,this.crop.y=t.y,this.crop.width=t.width,this.crop.height=t.height,!this.trim&&(t.x+t.width>this.baseTexture.width||t.y+t.height>this.baseTexture.height))throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.valid=t&&t.width&&t.height&&this.baseTexture.source&&this.baseTexture.hasLoaded,this.trim&&(this.width=this.trim.width,this.height=this.trim.height,this.frame.width=this.trim.width,this.frame.height=this.trim.height),this.valid&&this._updateUvs()},E.Texture.prototype._updateUvs=function(){this._uvs||(this._uvs=new E.TextureUvs);var t=this.crop,e=this.baseTexture.width,i=this.baseTexture.height;this._uvs.x0=t.x/e,this._uvs.y0=t.y/i,this._uvs.x1=(t.x+t.width)/e,this._uvs.y1=t.y/i,this._uvs.x2=(t.x+t.width)/e,this._uvs.y2=(t.y+t.height)/i,this._uvs.x3=t.x/e,this._uvs.y3=(t.y+t.height)/i},E.Texture.fromImage=function(t,e,i){var s=E.TextureCache[t];return s||(s=new E.Texture(E.BaseTexture.fromImage(t,e,i)),E.TextureCache[t]=s),s},E.Texture.fromFrame=function(t){var e=E.TextureCache[t];if(!e)throw new Error('The frameId "'+t+'" does not exist in the texture cache ');return e},E.Texture.fromCanvas=function(t,e){var i=E.BaseTexture.fromCanvas(t,e);return new E.Texture(i)},E.Texture.addTextureToCache=function(t,e){E.TextureCache[e]=t},E.Texture.removeTextureFromCache=function(t){var e=E.TextureCache[t];return delete E.TextureCache[t],delete E.BaseTextureCache[t],e},E.TextureUvs=function(){this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.x3=0,this.y3=0},E.Texture.emptyTexture=new E.Texture(new E.BaseTexture),E.RenderTexture=function(t,e,i,s,r){var n;this.width=t||100,this.height=e||100,this.resolution=r||1,this.frame=new E.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution),this.crop=new E.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution),this.baseTexture=new E.BaseTexture,this.baseTexture.width=this.width*this.resolution,this.baseTexture.height=this.height*this.resolution,this.baseTexture._glTextures=[],this.baseTexture.resolution=this.resolution,this.baseTexture.scaleMode=s||E.scaleModes.DEFAULT,this.baseTexture.hasLoaded=!0,E.Texture.call(this,this.baseTexture,new E.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution)),this.renderer=i||E.defaultRenderer,this.renderer.type===E.WEBGL_RENDERER?(n=this.renderer.gl,this.baseTexture._dirty[n.id]=!1,this.textureBuffer=new E.FilterTexture(n,this.width,this.height,this.baseTexture.scaleMode),this.baseTexture._glTextures[n.id]=this.textureBuffer.texture,this.render=this.renderWebGL,this.projection=new E.Point(.5*this.width,.5*-this.height)):(this.render=this.renderCanvas,this.textureBuffer=new E.CanvasBuffer(this.width*this.resolution,this.height*this.resolution),this.baseTexture.source=this.textureBuffer.canvas),this.valid=!0,this._updateUvs()},E.RenderTexture.prototype=Object.create(E.Texture.prototype),E.RenderTexture.prototype.constructor=E.RenderTexture,E.RenderTexture.prototype.resize=function(t,e,i){t===this.width&&e===this.height||(this.valid=0<t&&0<e,this.width=t,this.height=e,this.frame.width=this.crop.width=t*this.resolution,this.frame.height=this.crop.height=e*this.resolution,i&&(this.baseTexture.width=this.width*this.resolution,this.baseTexture.height=this.height*this.resolution),this.renderer.type===E.WEBGL_RENDERER&&(this.projection.x=this.width/2,this.projection.y=-this.height/2),this.valid&&this.textureBuffer.resize(this.width,this.height))},E.RenderTexture.prototype.clear=function(){this.valid&&(this.renderer.type===E.WEBGL_RENDERER&&this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,this.textureBuffer.frameBuffer),this.textureBuffer.clear())},E.RenderTexture.prototype.renderWebGL=function(t,e,i){if(this.valid){var s=t.worldTransform;s.identity(),s.translate(0,2*this.projection.y),e&&s.append(e),s.scale(1,-1),t.worldAlpha=1;for(var r=t.children,n=0,o=r.length;n<o;n++)r[n].updateTransform();var h=this.renderer.gl;h.viewport(0,0,this.width*this.resolution,this.height*this.resolution),h.bindFramebuffer(h.FRAMEBUFFER,this.textureBuffer.frameBuffer),i&&this.textureBuffer.clear(),this.renderer.spriteBatch.dirty=!0,this.renderer.renderDisplayObject(t,this.projection,this.textureBuffer.frameBuffer),this.renderer.spriteBatch.dirty=!0}},E.RenderTexture.prototype.renderCanvas=function(t,e,i){if(this.valid){var s=t.worldTransform;s.identity(),e&&s.append(e),t.worldAlpha=1;for(var r=t.children,n=0,o=r.length;n<o;n++)r[n].updateTransform();i&&this.textureBuffer.clear();var h=this.textureBuffer.context,a=this.renderer.resolution;this.renderer.resolution=this.resolution,this.renderer.renderDisplayObject(t,h),this.renderer.resolution=a}},E.RenderTexture.prototype.getImage=function(){var t=new Image;return t.src=this.getBase64(),t},E.RenderTexture.prototype.getBase64=function(){return this.getCanvas().toDataURL()},E.RenderTexture.prototype.getCanvas=function(){if(this.renderer.type!==E.WEBGL_RENDERER)return this.textureBuffer.canvas;var t=this.renderer.gl,e=this.textureBuffer.width,i=this.textureBuffer.height,s=new Uint8Array(4*e*i);t.bindFramebuffer(t.FRAMEBUFFER,this.textureBuffer.frameBuffer),t.readPixels(0,0,e,i,t.RGBA,t.UNSIGNED_BYTE,s),t.bindFramebuffer(t.FRAMEBUFFER,null);var r=new E.CanvasBuffer(e,i),n=r.context.getImageData(0,0,e,i);return n.data.set(s),r.context.putImageData(n,0,0),r.canvas},E.RenderTexture.tempMatrix=new E.Matrix,E.AssetLoader=function(t,e){this.assetURLs=t,this.crossorigin=e,this.loadersByType={jpg:E.ImageLoader,jpeg:E.ImageLoader,png:E.ImageLoader,gif:E.ImageLoader,webp:E.ImageLoader,json:E.JsonLoader,atlas:E.AtlasLoader,anim:E.SpineLoader,xml:E.BitmapFontLoader,fnt:E.BitmapFontLoader}},E.EventTarget.mixin(E.AssetLoader.prototype),E.AssetLoader.prototype.constructor=E.AssetLoader,E.AssetLoader.prototype._getDataType=function(t){var e="data:";if(t.slice(0,e.length).toLowerCase()!==e)return null;var i=t.slice(e.length),s=i.indexOf(",");if(-1===s)return null;var r=i.slice(0,s).split(";")[0];return r&&"text/plain"!==r.toLowerCase()?r.split("/").pop().toLowerCase():"txt"},E.AssetLoader.prototype.load=function(){var e=this;function t(t){e.onAssetLoaded(t.data.content)}this.loadCount=this.assetURLs.length;for(var i=0;i<this.assetURLs.length;i++){var s=this.assetURLs[i],r=(r=this._getDataType(s))||s.split("?").shift().split(".").pop().toLowerCase(),n=this.loadersByType[r];if(!n)throw new Error(r+" is an unsupported file type");var o=new n(s,this.crossorigin);o.on("loaded",t),o.load()}},E.AssetLoader.prototype.onAssetLoaded=function(t){this.loadCount--,this.emit("onProgress",{content:this,loader:t,loaded:this.assetURLs.length-this.loadCount,total:this.assetURLs.length}),this.onProgress&&this.onProgress(t),this.loadCount||(this.emit("onComplete",{content:this}),this.onComplete&&this.onComplete())},E.JsonLoader=function(t,e){this.url=t,this.crossorigin=e,this.baseUrl=t.replace(/[^\/]*$/,""),this.loaded=!1},E.JsonLoader.prototype.constructor=E.JsonLoader,E.EventTarget.mixin(E.JsonLoader.prototype),E.JsonLoader.prototype.load=function(){window.XDomainRequest&&this.crossorigin?(this.ajaxRequest=new window.XDomainRequest,this.ajaxRequest.timeout=3e3,this.ajaxRequest.onerror=this.onError.bind(this),this.ajaxRequest.ontimeout=this.onError.bind(this),this.ajaxRequest.onprogress=function(){},this.ajaxRequest.onload=this.onJSONLoaded.bind(this)):(window.XMLHttpRequest?this.ajaxRequest=new window.XMLHttpRequest:this.ajaxRequest=new window.ActiveXObject("Microsoft.XMLHTTP"),this.ajaxRequest.onreadystatechange=this.onReadyStateChanged.bind(this)),this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.send()},E.JsonLoader.prototype.onReadyStateChanged=function(){4!==this.ajaxRequest.readyState||200!==this.ajaxRequest.status&&-1!==window.location.href.indexOf("http")||this.onJSONLoaded()},E.JsonLoader.prototype.onJSONLoaded=function(){if(this.ajaxRequest.responseText)if(this.json=JSON.parse(this.ajaxRequest.responseText),this.json.frames&&this.json.meta&&this.json.meta.image){var t=this.baseUrl+this.json.meta.image,e=new E.ImageLoader(t,this.crossorigin),i=this.json.frames;for(var s in this.texture=e.texture.baseTexture,e.addEventListener("loaded",this.onLoaded.bind(this)),i){var r,n,o,h,a,l=i[s].frame;l&&(n=(r=new E.Rectangle(l.x,l.y,l.w,l.h)).clone(),a=null,i[s].trimmed&&(o=i[s].sourceSize,h=i[s].spriteSourceSize,a=new E.Rectangle(h.x,h.y,o.w,o.h)),E.TextureCache[s]=new E.Texture(this.texture,r,n,a))}e.load()}else{var c,d,u;!this.json.bones||E.AnimCache[this.url]?this.onLoaded():(c=this.url.substr(0,this.url.lastIndexOf("."))+".atlas",d=new E.JsonLoader(c,this.crossorigin),u=this,d.onJSONLoaded=function(){var t,e,i,s;this.ajaxRequest.responseText?(t=new E.SpineTextureLoader(this.url.substring(0,this.url.lastIndexOf("/"))),e=new spine.Atlas(this.ajaxRequest.responseText,t),i=new spine.AtlasAttachmentLoader(e),s=new spine.SkeletonJson(i).readSkeletonData(u.json),E.AnimCache[u.url]=s,u.spine=s,u.spineAtlas=e,u.spineAtlasLoader=d,0<t.loadingCount?t.addEventListener("loadedBaseTexture",function(t){t.content.content.loadingCount<=0&&u.onLoaded()}):u.onLoaded()):this.onError()},d.load())}else this.onError()},E.JsonLoader.prototype.onLoaded=function(){this.loaded=!0,this.dispatchEvent({type:"loaded",content:this})},E.JsonLoader.prototype.onError=function(){this.dispatchEvent({type:"error",content:this})},E.AtlasLoader=function(t,e){this.url=t,this.baseUrl=t.replace(/[^\/]*$/,""),this.crossorigin=e,this.loaded=!1},E.AtlasLoader.constructor=E.AtlasLoader,E.EventTarget.mixin(E.AtlasLoader.prototype),E.AtlasLoader.prototype.load=function(){this.ajaxRequest=new E.AjaxRequest,this.ajaxRequest.onreadystatechange=this.onAtlasLoaded.bind(this),this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/json"),this.ajaxRequest.send(null)},E.AtlasLoader.prototype.onAtlasLoaded=function(){if(4===this.ajaxRequest.readyState)if(200===this.ajaxRequest.status||-1===window.location.href.indexOf("http")){this.atlas={meta:{image:[]},frames:[]};for(var t,e,i=this.ajaxRequest.responseText.split(/\r?\n/),s=-3,r=0,n=null,o=!1,h=0,a=0,l=this.onLoaded.bind(this),h=0;h<i.length;h++){i[h]=i[h].replace(/^\s+|\s+$/g,""),""===i[h]&&(o=h+1),0<i[h].length&&(o===h?(this.atlas.meta.image.push(i[h]),r=this.atlas.meta.image.length-1,this.atlas.frames.push({}),s=-3):0<s&&(s%7==1?(null!=n&&(this.atlas.frames[r][n.name]=n),n={name:i[h],frame:{}}):(t=i[h].split(" "),s%7==3?(n.frame.x=Number(t[1].replace(",","")),n.frame.y=Number(t[2])):s%7==4?(n.frame.w=Number(t[1].replace(",","")),n.frame.h=Number(t[2])):s%7==5&&((e={x:0,y:0,w:Number(t[1].replace(",","")),h:Number(t[2])}).w>n.frame.w||e.h>n.frame.h?(n.trimmed=!0,n.realSize=e):n.trimmed=!1))),s++)}if(null!=n&&(this.atlas.frames[r][n.name]=n),0<this.atlas.meta.image.length){for(this.images=[],a=0;a<this.atlas.meta.image.length;a++){var c=this.baseUrl+this.atlas.meta.image[a],d=this.atlas.frames[a];for(h in this.images.push(new E.ImageLoader(c,this.crossorigin)),d){var u=d[h].frame;u&&(E.TextureCache[h]=new E.Texture(this.images[a].texture.baseTexture,{x:u.x,y:u.y,width:u.w,height:u.h}),d[h].trimmed&&(E.TextureCache[h].realSize=d[h].realSize,E.TextureCache[h].trim.x=0,E.TextureCache[h].trim.y=0))}}for(a=this.currentImageId=0;a<this.images.length;a++)this.images[a].on("loaded",l);this.images[this.currentImageId].load()}else this.onLoaded()}else this.onError()},E.AtlasLoader.prototype.onLoaded=function(){this.images.length-1>this.currentImageId?(this.currentImageId++,this.images[this.currentImageId].load()):(this.loaded=!0,this.emit("loaded",{content:this}))},E.AtlasLoader.prototype.onError=function(){this.emit("error",{content:this})},E.SpriteSheetLoader=function(t,e){this.url=t,this.crossorigin=e,this.baseUrl=t.replace(/[^\/]*$/,""),this.texture=null,this.frames={}},E.SpriteSheetLoader.prototype.constructor=E.SpriteSheetLoader,E.EventTarget.mixin(E.SpriteSheetLoader.prototype),E.SpriteSheetLoader.prototype.load=function(){var e=this,t=new E.JsonLoader(this.url,this.crossorigin);t.on("loaded",function(t){e.json=t.data.content.json,e.onLoaded()}),t.load()},E.SpriteSheetLoader.prototype.onLoaded=function(){this.emit("loaded",{content:this})},E.ImageLoader=function(t,e){this.texture=E.Texture.fromImage(t,e),this.frames=[]},E.ImageLoader.prototype.constructor=E.ImageLoader,E.EventTarget.mixin(E.ImageLoader.prototype),E.ImageLoader.prototype.load=function(){this.texture.baseTexture.hasLoaded?this.onLoaded():this.texture.baseTexture.on("loaded",this.onLoaded.bind(this))},E.ImageLoader.prototype.onLoaded=function(){this.emit("loaded",{content:this})},E.ImageLoader.prototype.loadFramedSpriteSheet=function(t,e,i){this.frames=[];for(var s=Math.floor(this.texture.width/t),r=Math.floor(this.texture.height/e),n=0,o=0;o<r;o++)for(var h=0;h<s;h++,n++){var a=new E.Texture(this.texture.baseTexture,{x:h*t,y:o*e,width:t,height:e});this.frames.push(a),i&&(E.TextureCache[i+"-"+n]=a)}this.load()},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=E),exports.PIXI=E):"undefined"!=typeof define&&define.amd?define(E):this.PIXI=E}).call(this);